<!DOCTYPE html>
{% load static %}
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pegpo Gemini Chat</title>
    <!-- 1. Include Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- 2. Include Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="{% static 'css/chat_app.css' %}">
</head>

<body>

    <div class="d-flex vh-100" id="appContainer">

        <!-- SIDEBAR (Left Column) -->
        <aside id="sidebar" class="d-flex flex-column flex-shrink-0 border-end">
            <div class="d-flex flex-column align-items-center mb-4 pt-3 position-relative" style="height: 100px;">
                <div class="sidebar-close-area" style="position: absolute; top: 0; left: 0; width: 100%; height: 60px;">
                </div>
                <div class="avatar-ai mb-4">
                    Ai
                </div>
                <button class="new-btn border-0 fs-4 text-white" id="newChatBtn" title="Start a New Chat">
                    <i class="bi bi-plus-lg"></i>
                </button>
            </div>
            <nav class="d-flex flex-column align-items-center flex-grow-1">
                <a href="#" class="nav-link-item active" id="nav-home">
                    <div class="sidebar-icon-wrapper fs-5"><i class="bi bi-app"></i></div>
                    <div class="mt-1">Home</div>
                </a>
                <div class="sidebar-separator"></div>
                <a href="#" class="nav-link-item" id="nav-projects">
                    <div class="sidebar-icon-wrapper fs-5"><i class="bi bi-folder2"></i></div>
                    <div class="mt-1">Projects</div>
                </a>
                <a href="#" class="nav-link-item" id="nav-explore">
                    <div class="sidebar-icon-wrapper fs-5"><i class="bi bi-compass"></i></div>
                    <div class="mt-1">Explore</div>
                </a>
                <a href="#" class="nav-link-item" id="nav-drive">
                    <div class="sidebar-icon-wrapper fs-5"><i class="bi bi-box-seam-fill"></i></div>
                    <div class="mt-1">Drive</div>
                </a>
            </nav>
            <div class="mt-auto d-flex flex-column align-items-center pb-3">
                <div class="sidebar-icon-wrapper fs-5 pt-3"><i class="bi bi-brightness-high"></i></div>
                <div class="sidebar-icon-wrapper fs-5 pt-3"><i class="bi bi-bell"></i></div>
                <div class="sidebar-icon-wrapper fs-5 pt-3"><i class="bi bi-person-fill"></i></div>
                <div class="sidebar-icon-wrapper fs-5 pt-3"><i class="bi bi-arrow-clockwise"></i></div>
            </div>
        </aside>

        <!-- MAIN CHAT AREA (Right Column) -->
        <main class="main-area flex-grow-1 p-4 position-relative" id="mainContentArea">

            <!-- Only menu button in header -->
            <header class="mb-5 d-flex align-items-center main-area-container">
                <button id="menuToggle" class="btn btn-link text-white p-0 me-3 d-lg-none" style="font-size: 1.5rem;">
                    <i class="bi bi-list"></i>
                </button>
            </header>

            <!-- CENTERED/FIXED INPUT AND PILLS CONTAINER -->
            <div id="initial-center-container" class="d-flex flex-column align-items-center">

                <!-- PEGPO LOGO (centered above rectangle) -->
                <div id="pegpoLogo" class="pegpo-logo centered-logo">
                    <span class="logo-text">Pegpo</span>
                    <span class="pro-tag">Pro</span>
                </div>

                <!-- INPUT SECTION (Rectangle) -->
                <section class="chat-rect-container d-flex flex-column p-4">

                    <div class="flex-grow-1 mb-2">
                        <textarea id="chatInput" class="form-control bg-transparent border-0 chat-input-textarea"
                            placeholder="Ask anything. Type @ For mentions." rows="2"
                            style="min-height: 48px;"></textarea>
                    </div>

                    <div class="d-flex justify-content-between align-items-center mt-2">

                        <div class="d-flex align-items-center gap-3">
                            <div class="control-pill-wrapper">
                                <div class="control-pill-ai text-white">
                                    <i class="bi bi-search"></i>
                                </div>
                                <i class="bi bi-globe chat-control-icon text-white"></i>
                                <i class="bi bi-magic chat-control-icon text-white"></i>
                            </div>
                        </div>

                        <div class="d-flex align-items-center gap-3">
                            <i class="bi bi-toggle-on chat-control-icon text-white"></i>
                            <i class="bi bi-paperclip chat-control-icon text-white"></i>
                            <i class="bi bi-link-45deg chat-control-icon text-white"></i>
                            <i class="bi bi-mic chat-control-icon text-white"></i>

                            <button class="send-button-wrapper text-white border-0 p-0" id="sendButton" disabled>
                                <i class="bi bi-send-fill"></i>
                            </button>
                        </div>
                    </div>
                </section>

                <!-- ACTION PILLS -->
                <div id="action-pills" class="d-flex justify-content-center flex-wrap">
                    <button class="action-pill d-flex align-items-center">
                        <i class="bi bi-lightbulb-fill me-2"></i> Think
                    </button>
                    <button class="action-pill d-flex align-items-center">
                        <i class="bi bi-lightbulb me-2"></i> Deep Thinking
                    </button>
                    <button class="action-pill d-flex align-items-center">
                        <i class="bi bi-book-half me-2"></i> Study Learn
                    </button>
                    <button class="action-pill d-flex align-items-center">
                        <i class="bi bi-image me-2"></i> Create Image
                    </button>
                    <button class="action-pill d-flex align-items-center">
                        <i class="bi bi-easel-fill me-2"></i> Canvas
                    </button>
                </div>
            </div>

            <!-- CHAT HISTORY CONTAINER -->
            <div id="chat-content"></div>

            <div class="floating-controls">
                <div class="floating-circle text-white"><i class="bi bi-translate"></i></div>
                <div class="floating-circle text-white"><i class="bi bi-question-lg"></i></div>
            </div>
        </main>
    </div>

    <!-- PROJECTS SIDEBAR PANEL -->
    <div id="projects-sidebar-panel" class="d-flex flex-column">
        <div class="d-flex justify-content-between align-items-center mb-4 ps-2 pe-2">
            <div class="d-flex align-items-center gap-2 text-white">
                <i class="bi bi-folder-plus fs-5"></i>
                <span class="fw-semibold">New Projects</span>
            </div>
            <i class="bi bi-x fs-4 cursor-pointer text-white" id="closeProjectsPanel" style="cursor: pointer;"></i>
        </div>

        <!-- Project List Item (Dummy) -->
        <div class="project-item d-flex align-items-center p-2 rounded mb-2">
            <div class="project-icon-circle green me-3">
                <i class="bi bi-currency-dollar"></i>
            </div>
            <span class="text-white small">Investing</span>
        </div>

        <div class="mt-auto">
            <!-- Add Project Button -->
            <!-- We might want this at the top or bottom, image showed header "New Projects" with icon, list items below. The + button usually is nearby. 
                 The request said: "there is a plus icon button in the sidebar, its used to add new project"
                 Let's put a separate button if needed or rely on the header icon? 
                 "if we click on that [plus icon button], the create project section will came...".
                 Wait, the image shows a header "New Projects" with a folder+ icon. Maybe THAT is the button?
                 Or maybe there is a big "+" button in the previous sidebar?
                 "there is a plus icon button in the sidebar" -> Referencing the main sidebar?
                 "Projects... if we click on projects another sidebar shows... there is a plus icon button in the sidebar [which one?], its used to add new project"
                 
                 Looking at Image 1: Top of secondary sidebar has "Folder+" icon and "New Projects" text.
                 It also has an "X".
                 Maybe the "Folder+" icon IS the button?
                 
                 Let's assume the "Folder+" icon area or a specific button triggers it.
                 I'll add a distinct button for clarity if needed, or make the header clickable?
                 
                 Actually, looking at the image again (Image 1):
                 Left Sidebar (Main): Ai, +, Home, Projects...
                 Next to it (Secondary): Top header "New Projects" (Folder+ icon). Below it "Investing" (Green).
                 
                 The user says: "there is a plus icon button in the sidebar, its used to add new project if we click on that , the create project section will came"
                 This might refer to the `+` button in the MAIN sidebar (under `Ai` avatar).
                 
                 Let's assume the `+` in the main sidebar opens a "New Chat" (current behavior).
                 And inside the "Projects" sidebar panel, there should be a way to add a project.
                 
                 I'll add a 'plus' button inside the panel as well for good measure or make the header icon interactive.
                 
                 BUT, looking closer at the provided text: "if we click on projects another sidebar shows exactly in the photo... there is a plus icon button in the sidebar... if we click on that... create project section will came"
                 
                 In the image "New Projects" header has a Folder icon with a small plus. That looks like a label.
                 
                 I will add a specific "Create Project" button inside this panel, or maybe the user meant the existing "+" on the left?
                 The existing "+" is usually for New Chat.
                 
                 Let's look at the image 1 again.
                 There is a `+` button in the main sidebar below `Ai`.
                 
                 If the user means *that* button adds a project, that would be a change of functionality (it usually adds a chat).
                 However, usually "New Projects" panel allows adding projects.
                 
                 Let's add a `+` button in the secondary panel closely matching the "New Projects" header or just below it.
                 Or maybe the "New Projects" header IS the button?
                 "New Projects" implies a list of new projects? Or "Your Projects"?
                 Image text says "New Projects".
                 
                 I'll stick to the text: "plus icon button in the sidebar"
                 I'll add a '+' button in the secondary sidebar.
            -->
            <!-- I'll add a generic add button -->
            <button id="addProjectBtnSidebar"
                class="btn btn-dark w-100 mb-3 d-flex align-items-center justify-content-center gap-2">
                <i class="bi bi-plus-lg"></i> Create Project
            </button>
        </div>
    </div>

    <!-- CREATE PROJECT MODAL OVERLAY -->
    <div id="createProjectModalOverlay" class="modal-overlay hidden">
        <div class="create-project-modal">
            <h3 class="text-white mb-4 fs-4 fw-normal">Project name</h3>

            <input type="text" id="newProjectName" class="form-control project-input mb-4"
                placeholder="Copenhagen Trip">

            <div class="d-flex gap-2 mb-4 flex-wrap">
                <button class="project-pill-select active" data-color="green">
                    <div class="circle-icon green"><i class="bi bi-currency-dollar"></i></div> Investing
                </button>
                <button class="project-pill-select" data-color="blue">
                    <div class="circle-icon blue"><i class="bi bi-mortarboard"></i></div> Homework
                </button>
                <button class="project-pill-select" data-color="purple">
                    <div class="circle-icon purple"><i class="bi bi-pen"></i></div> Writing
                </button>
                <button class="project-pill-select" data-color="red">
                    <div class="circle-icon red"><i class="bi bi-heart"></i></div> Health
                </button>
                <button class="project-pill-select" data-color="orange">
                    <div class="circle-icon orange"><i class="bi bi-airplane"></i></div> Travel
                </button>
            </div>

            <div class="project-info-box p-3 mb-4">
                Projects keep chats, files and custom instruction in one place. use them for ongoing work, or just to
                keep things tidy
            </div>

            <div class="d-flex justify-content-end">
                <button id="createProjectConfirmBtn" class="btn btn-create-project">
                    <i class="bi bi-plus-lg me-1"></i> Create project
                </button>
            </div>
        </div>
    </div>

    <!-- 5. Include Firebase JS SDKs -->
    <script type="module" src="{% static 'js/chat_app.js' %}"></script>
</body>

</html>